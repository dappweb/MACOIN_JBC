# 前端更新说明 - 级差奖励逻辑变更

## 📋 概述

合约升级后，**级差奖励的计算逻辑已更改**，前端需要更新相关说明文字以反映新的机制。

## 🔄 变更内容

### 合约变更
- **之前**: 级差奖励在质押流动性时计算，基于质押金额
- **现在**: 级差奖励在赎回流动性时计算，基于静态收益

### 前端需要更新的内容

## ✅ 已更新的文件

### 1. `components/DifferentialRewardStatus.tsx`

**更新位置 1** (第282-285行):
```tsx
// 之前:
<li>• 当您的下级用户进行质押时，系统会自动计算极差奖励</li>
<li>• 奖励金额 = 质押金额 × (您的等级比例 - 下级等级比例)</li>
<li>• 极差奖励会在下级质押时立即发放到您的账户</li>

// 现在:
<li>• 当您的下级用户赎回流动性时，系统会基于其静态收益计算极差奖励</li>
<li>• 奖励金额 = 静态收益 × (您的等级比例 - 下级等级比例)</li>
<li>• 极差奖励会在下级赎回时立即发放到您的账户 (50% MC + 50% JBC)</li>
```

**更新位置 2** (第267行):
```tsx
// 之前:
当您的下级进行质押时，将自动获得极差奖励

// 现在:
当您的下级赎回流动性时，将基于其静态收益获得极差奖励
```

### 2. `components/MiningPanel.tsx`

**更新位置** (第1640行):
```tsx
// 之前:
<li>极差奖励：基于V等级的团队奖励，30天后解锁 (纯MC)</li>

// 现在:
<li>极差奖励：基于V等级的团队奖励，在下级赎回时基于静态收益计算 (50% MC + 50% JBC)</li>
```

## 🔍 不需要更新的部分

以下部分**不需要更新**，因为它们仍然正确工作：

### 1. 事件监听
- ✅ `DifferentialRewardDistributed` 事件监听 - 仍然在赎回时触发
- ✅ `DifferentialRewardReleased` 事件监听 - 仍然在赎回时触发
- ✅ `EarningsDetail.tsx` 中的事件处理逻辑 - 无需更改

### 2. 数据显示
- ✅ 级差奖励的显示逻辑 - 无需更改
- ✅ 统计面板的级差奖励统计 - 无需更改
- ✅ 奖励记录的展示 - 无需更改

### 3. 用户交互
- ✅ 质押流动性功能 - 无需更改
- ✅ 赎回流动性功能 - 无需更改
- ✅ 奖励领取功能 - 无需更改

## 📝 验证清单

升级合约后，请验证以下内容：

### 功能验证
- [ ] 用户质押流动性时，**不应该**看到级差奖励相关的提示
- [ ] 用户赎回流动性时，上级**应该**收到级差奖励
- [ ] 级差奖励显示为 50% MC + 50% JBC
- [ ] 级差奖励金额基于静态收益，而不是质押金额

### UI验证
- [ ] `DifferentialRewardStatus` 组件显示正确的说明文字
- [ ] `MiningPanel` 组件显示正确的奖励说明
- [ ] 所有级差奖励相关的提示文字已更新

### 事件验证
- [ ] `DifferentialRewardDistributed` 事件在赎回时正确触发
- [ ] `DifferentialRewardReleased` 事件在赎回时正确触发
- [ ] 前端正确解析和显示这些事件

## 🚀 部署步骤

1. **更新前端代码**
   ```bash
   # 确保所有更改已提交
   git add components/DifferentialRewardStatus.tsx components/MiningPanel.tsx
   git commit -m "更新级差奖励说明文字，反映新的计算逻辑"
   ```

2. **构建前端**
   ```bash
   npm run build
   ```

3. **部署前端**
   ```bash
   # 根据您的部署方式执行
   npm run deploy
   # 或
   npm run pages:deploy:prod
   ```

4. **验证部署**
   - 检查前端是否正常加载
   - 验证说明文字是否正确显示
   - 测试级差奖励功能是否正常工作

## ⚠️ 注意事项

1. **向后兼容性**: 前端代码的更改是纯UI层面的，不影响功能逻辑
2. **事件兼容**: 合约事件格式没有变化，前端的事件监听代码无需修改
3. **用户体验**: 更新说明文字有助于用户理解新的奖励机制

## 📞 支持

如有问题，请检查：
- 前端构建日志
- 浏览器控制台错误
- 合约事件日志

---

**最后更新**: 2024年12月
**前端版本**: 与 JinbaoProtocolV4 合约升级配套

