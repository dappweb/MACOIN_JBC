# 测试环境时间单位转换规格

## 介绍

本规格旨在为Jinbao Protocol创建一个快速测试环境，将流动性质押周期从生产环境的"天"转换为测试环境的"分钟"。这样可以让开发者和测试人员在几分钟内验证质押功能，而不需要等待数天时间，大大提高开发和测试效率。

## 术语表

- **测试环境 (Test_Environment)**: 专门用于快速功能验证的环境，使用分钟作为质押周期单位
- **生产环境 (Production_Environment)**: 面向真实用户的环境，使用天作为质押周期单位
- **时间单位转换 (Time_Unit_Conversion)**: 将质押周期从天数转换为分钟数的过程
- **原生MC代币 (Native_MC_Token)**: 使用区块链原生代币而非ERC20代币，简化用户交互
- **智能时间检测 (Smart_Time_Detection)**: 前端自动检测合约时间单位并调整显示的机制
- **UUPS代理 (UUPS_Proxy)**: 可升级的智能合约代理模式，支持合约逻辑升级

## 需求

### 需求 1: 测试环境合约部署

**用户故事**: 作为区块链开发者，我希望部署一个使用分钟作为时间单位的测试合约，这样我就能在几分钟内验证质押功能而不需要等待数天。

#### 验收标准

1. WHEN 部署测试环境合约 THEN 系统 SHALL 设置 SECONDS_IN_UNIT = 60 (1分钟)
2. WHEN 合约初始化 THEN 系统 SHALL 使用原生MC代币而非ERC20 MC代币
3. WHEN 验证合约配置 THEN 系统 SHALL 确认时间单位为60秒
4. WHEN 部署完成 THEN 系统 SHALL 提供新的合约地址用于前端配置
5. WHEN 合约部署 THEN 系统 SHALL 使用UUPS代理模式保持可升级性

### 需求 2: 质押周期时间转换

**用户故事**: 作为测试人员，我希望质押周期从天数转换为对应的分钟数，这样我就能快速测试不同周期的质押功能。

#### 验收标准

1. WHEN 用户选择7天质押 THEN 系统 SHALL 实际执行7分钟质押
2. WHEN 用户选择15天质押 THEN 系统 SHALL 实际执行15分钟质押
3. WHEN 用户选择30天质押 THEN 系统 SHALL 实际执行30分钟质押
4. WHEN 计算收益率 THEN 系统 SHALL 保持相同的每单位时间收益率
5. WHEN 显示质押信息 THEN 系统 SHALL 正确显示分钟数而非天数

### 需求 3: 前端智能适配

**用户故事**: 作为前端开发者，我希望前端能自动检测合约的时间单位并调整显示，这样同一套代码就能适配测试和生产环境。

#### 验收标准

1. WHEN 前端连接到合约 THEN 系统 SHALL 自动检测 SECONDS_IN_UNIT 值
2. WHEN 检测到60秒单位 THEN 系统 SHALL 显示分钟相关的标签和倒计时
3. WHEN 检测到86400秒单位 THEN 系统 SHALL 显示天数相关的标签和倒计时
4. WHEN 时间单位改变 THEN 系统 SHALL 动态更新所有时间显示组件
5. WHEN 环境切换 THEN 系统 SHALL 无需代码修改即可适配不同时间单位

### 需求 4: 原生MC代币集成

**用户故事**: 作为协议用户，我希望在测试环境中使用原生MC代币进行质押，这样我就不需要进行代币授权等复杂操作。

#### 验收标准

1. WHEN 用户购买门票 THEN 系统 SHALL 直接使用原生MC代币支付
2. WHEN 用户提供流动性 THEN 系统 SHALL 直接使用原生MC代币质押
3. WHEN 用户进行交易 THEN 系统 SHALL 不需要ERC20代币授权步骤
4. WHEN 显示余额 THEN 系统 SHALL 显示原生MC代币余额
5. WHEN 刷新余额 THEN 系统 SHALL 查询原生代币余额而非ERC20余额

### 需求 5: 时间显示和计算

**用户故事**: 作为测试用户，我希望看到准确的分钟级倒计时和收益计算，这样我就能验证系统的时间逻辑是否正确。

#### 验收标准

1. WHEN 查看质押倒计时 THEN 系统 SHALL 显示分钟和秒的倒计时格式
2. WHEN 计算质押收益 THEN 系统 SHALL 使用分钟作为时间基准计算
3. WHEN 显示剩余时间 THEN 系统 SHALL 使用"X分钟Y秒"的格式
4. WHEN 质押到期 THEN 系统 SHALL 在指定分钟数后允许领取奖励
5. WHEN 查看历史记录 THEN 系统 SHALL 显示分钟级的质押周期信息

### 需求 6: 配置管理和环境切换

**用户故事**: 作为系统管理员，我希望能够轻松地在测试和生产环境之间切换，这样我就能使用相同的代码库管理不同的部署环境。

#### 验收标准

1. WHEN 配置测试环境 THEN 系统 SHALL 使用测试专用的合约地址
2. WHEN 配置生产环境 THEN 系统 SHALL 使用生产专用的合约地址
3. WHEN 环境配置更新 THEN 系统 SHALL 自动应用对应的时间单位设置
4. WHEN 部署脚本运行 THEN 系统 SHALL 根据环境参数部署正确的合约版本
5. WHEN 验证环境 THEN 系统 SHALL 提供环境配置验证工具

### 需求 7: 测试和验证工具

**用户故事**: 作为质量保证工程师，我希望有专门的工具来验证测试环境的配置和功能，这样我就能确保测试环境正确模拟了生产环境的业务逻辑。

#### 验收标准

1. WHEN 运行合约验证脚本 THEN 系统 SHALL 确认合约时间单位配置正确
2. WHEN 测试前端时间检测 THEN 系统 SHALL 验证前端能正确识别时间单位
3. WHEN 执行功能测试 THEN 系统 SHALL 提供完整的测试流程指导
4. WHEN 验证收益计算 THEN 系统 SHALL 确认分钟级收益计算的准确性
5. WHEN 检查数据一致性 THEN 系统 SHALL 验证前端显示与合约状态的一致性

### 需求 8: 性能和用户体验

**用户故事**: 作为测试环境用户，我希望分钟级的时间更新不会影响系统性能，并且能提供流畅的用户体验。

#### 验收标准

1. WHEN 倒计时更新 THEN 系统 SHALL 在不影响性能的情况下每秒更新显示
2. WHEN 处理多个质押记录 THEN 系统 SHALL 高效地计算和显示所有倒计时
3. WHEN 用户交互 THEN 系统 SHALL 提供即时的反馈和状态更新
4. WHEN 数据刷新 THEN 系统 SHALL 优化网络请求避免过度查询
5. WHEN 页面加载 THEN 系统 SHALL 快速检测和应用正确的时间单位配置

### 需求 9: 错误处理和降级

**用户故事**: 作为系统用户，我希望当时间单位检测或转换出现问题时，系统能提供清晰的错误信息和合理的降级方案。

#### 验收标准

1. WHEN 时间单位检测失败 THEN 系统 SHALL 显示明确的错误信息
2. WHEN 合约连接异常 THEN 系统 SHALL 提供降级的时间显示方案
3. WHEN 时间计算错误 THEN 系统 SHALL 记录详细的错误日志
4. WHEN 环境配置冲突 THEN 系统 SHALL 提供配置修复建议
5. WHEN 用户遇到问题 THEN 系统 SHALL 提供故障排除指导

### 需求 10: 文档和部署指导

**用户故事**: 作为新的开发者，我希望有清晰的文档说明如何设置和使用测试环境，这样我就能快速上手并进行有效的测试。

#### 验收标准

1. WHEN 查看部署文档 THEN 系统 SHALL 提供详细的测试环境部署步骤
2. WHEN 配置前端 THEN 系统 SHALL 提供合约地址更新指导
3. WHEN 进行测试 THEN 系统 SHALL 提供完整的测试流程说明
4. WHEN 遇到问题 THEN 系统 SHALL 提供常见问题解答和解决方案
5. WHEN 环境切换 THEN 系统 SHALL 提供生产环境部署的对比说明