# 静态奖励显示问题修复需求文档

## 介绍

用户反映静态奖励不显示的问题。通过代码分析，发现可能存在多个原因导致静态奖励无法正确显示在前端界面中。

## 术语表

- **静态奖励 (Static Reward)**: 基于用户质押金额和时间产生的固定收益，奖励类型为 REWARD_STATIC (0)
- **质押 (Stake)**: 用户通过 stakeLiquidity 函数质押的 MC 代币
- **RewardClaimed 事件**: 合约触发的奖励领取事件，包含奖励类型和金额信息
- **EarningsDetail 组件**: 前端显示收益详情的组件
- **MiningPanel 组件**: 提供领取奖励功能的挖矿面板

## 需求

### 需求 1: 静态奖励数据获取

**用户故事:** 作为用户，我希望能够看到我的静态奖励记录，以便了解我的质押收益情况。

#### 验收标准

1. WHEN 用户有活跃的质押记录 THEN 系统应该能够正确计算静态奖励
2. WHEN 用户调用 claimRewards 函数 THEN 系统应该触发 RewardClaimed 事件并包含正确的静态奖励数据
3. WHEN RewardClaimed 事件被触发 THEN 前端应该能够正确解析事件数据
4. WHEN 前端获取到静态奖励事件 THEN 应该将其存储在 records 数组中
5. WHEN records 数组包含静态奖励记录 THEN dailyStats 计算应该正确统计静态奖励

### 需求 2: 质押状态验证

**用户故事:** 作为开发者，我需要验证用户的质押状态，确保静态奖励计算的前提条件正确。

#### 验收标准

1. WHEN 用户访问系统 THEN 系统应该检查用户是否有活跃的质押记录
2. WHEN 用户有质押记录 THEN 系统应该验证质押是否处于 active 状态
3. WHEN 质押处于活跃状态 THEN 系统应该计算已经过的时间单位
4. WHEN 时间单位大于0 THEN 系统应该计算应得的静态奖励
5. WHEN 用户的总收益未达到上限 THEN 静态奖励应该可以正常发放

### 需求 3: 事件监听和数据同步

**用户故事:** 作为用户，我希望在领取奖励后能够立即看到更新的奖励记录。

#### 验收标准

1. WHEN 用户成功领取奖励 THEN 前端应该自动刷新奖励记录
2. WHEN 奖励记录刷新 THEN 应该重新获取最新的区块链事件
3. WHEN 获取到新的 RewardClaimed 事件 THEN 应该更新 dailyStats 统计
4. WHEN dailyStats 更新 THEN 静态奖励的24小时统计应该正确显示
5. WHEN 缓存存在 THEN 系统应该提供强制刷新选项绕过缓存

### 需求 4: 错误处理和调试

**用户故事:** 作为开发者，我需要完善的错误处理和调试信息，以便快速定位静态奖励显示问题。

#### 验收标准

1. WHEN 获取质押记录失败 THEN 系统应该显示具体的错误信息
2. WHEN 解析 RewardClaimed 事件失败 THEN 系统应该记录详细的错误日志
3. WHEN 静态奖励计算异常 THEN 系统应该提供调试信息
4. WHEN 合约调用失败 THEN 系统应该显示用户友好的错误提示
5. WHEN 数据不一致 THEN 系统应该提供数据验证和修复机制

### 需求 5: 用户界面优化

**用户故事:** 作为用户，我希望有清晰的界面显示我的静态奖励状态和可领取金额。

#### 验收标准

1. WHEN 用户有待领取的静态奖励 THEN 界面应该显示可领取金额
2. WHEN 用户没有质押记录 THEN 界面应该提示用户进行质押
3. WHEN 静态奖励为0 THEN 界面应该解释原因（如：无质押、已达上限等）
4. WHEN 显示24小时统计 THEN 静态奖励应该与其他奖励类型一致显示
5. WHEN 用户点击刷新 THEN 应该强制重新获取最新数据

### 需求 6: 合约兼容性

**用户故事:** 作为系统管理员，我需要确保前端与当前部署的合约版本完全兼容。

#### 验收标准

1. WHEN 前端调用合约函数 THEN 应该使用正确的合约地址和ABI
2. WHEN 合约返回数据 THEN 前端应该正确解析数据结构
3. WHEN 合约触发事件 THEN 前端应该能够正确监听和处理
4. WHEN 合约常量发生变化 THEN 前端应该动态获取最新值
5. WHEN 合约升级 THEN 前端应该能够检测并适配新版本