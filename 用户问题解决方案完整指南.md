# ğŸ› ï¸ Jinbao Protocol ç”¨æˆ·é—®é¢˜è§£å†³æ–¹æ¡ˆå®Œæ•´æŒ‡å—

## ğŸ“Š é—®é¢˜åˆ†ç±»æ¦‚è§ˆ

åŸºäºDeFiåè®®çš„å¤æ‚æ€§å’Œç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·é—®é¢˜åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¸»è¦ç±»åˆ«ï¼š

| é—®é¢˜ç±»åˆ« | ä¸¥é‡ç¨‹åº¦ | é¢‘ç‡ | å½±å“èŒƒå›´ |
|---------|---------|------|----------|
| **é’±åŒ…è¿æ¥é—®é¢˜** | ğŸ”´ é«˜ | ğŸ”¥ é«˜é¢‘ | æ–°ç”¨æˆ· |
| **äº¤æ˜“å¤±è´¥é—®é¢˜** | ğŸ”´ é«˜ | ğŸ”¥ é«˜é¢‘ | æ‰€æœ‰ç”¨æˆ· |
| **å¥–åŠ±ç†è§£é—®é¢˜** | ğŸŸ¡ ä¸­ | ğŸ”¥ é«˜é¢‘ | æ–°ç”¨æˆ· |
| **æ“ä½œæµç¨‹é—®é¢˜** | ğŸŸ¡ ä¸­ | ğŸ”¥ é«˜é¢‘ | æ–°ç”¨æˆ· |
| **æ•°æ®æ˜¾ç¤ºé—®é¢˜** | ğŸŸ¢ ä½ | ğŸŸ¡ ä¸­é¢‘ | éƒ¨åˆ†ç”¨æˆ· |
| **ç½‘ç»œé—®é¢˜** | ğŸ”´ é«˜ | ğŸŸ¡ ä¸­é¢‘ | æ‰€æœ‰ç”¨æˆ· |

---

## ğŸ”— é—®é¢˜ç±»åˆ«ä¸€ï¼šé’±åŒ…è¿æ¥é—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. é’±åŒ…æ— æ³•è¿æ¥
**é—®é¢˜æè¿°**: ç”¨æˆ·ç‚¹å‡»è¿æ¥é’±åŒ…åæ— å“åº”æˆ–è¿æ¥å¤±è´¥

**å¯èƒ½åŸå› **:
- MetaMaskæœªå®‰è£…æˆ–ç‰ˆæœ¬è¿‡æ—§
- ç½‘ç»œé…ç½®é”™è¯¯
- æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜
- é’±åŒ…è¢«å…¶ä»–dAppå ç”¨

**è§£å†³æ–¹æ¡ˆ**:

##### ğŸ“± å‰ç«¯ä¼˜åŒ–æ–¹æ¡ˆ
```typescript
// é’±åŒ…è¿æ¥æ£€æµ‹å’Œå¼•å¯¼
const WalletConnectionGuide = () => {
  const [connectionStatus, setConnectionStatus] = useState('checking');
  
  const checkWalletAvailability = async () => {
    // æ£€æµ‹MetaMaskæ˜¯å¦å®‰è£…
    if (!window.ethereum) {
      return {
        status: 'no_wallet',
        message: 'è¯·å®‰è£…MetaMaské’±åŒ…',
        action: 'install'
      };
    }
    
    // æ£€æµ‹ç½‘ç»œé…ç½®
    const chainId = await window.ethereum.request({ method: 'eth_chainId' });
    if (chainId !== '0x15A85') { // MC Chain ID: 88813
      return {
        status: 'wrong_network',
        message: 'è¯·åˆ‡æ¢åˆ°MC Chainç½‘ç»œ',
        action: 'switch_network'
      };
    }
    
    return { status: 'ready' };
  };
  
  const autoSwitchNetwork = async () => {
    try {
      await window.ethereum.request({
        method: 'wallet_switchEthereumChain',
        params: [{ chainId: '0x15A85' }],
      });
    } catch (switchError) {
      // ç½‘ç»œä¸å­˜åœ¨ï¼Œæ·»åŠ ç½‘ç»œ
      if (switchError.code === 4902) {
        await window.ethereum.request({
          method: 'wallet_addEthereumChain',
          params: [{
            chainId: '0x15A85',
            chainName: 'MC Chain',
            rpcUrls: ['https://chain.mcerscan.com/'],
            nativeCurrency: {
              name: 'MC',
              symbol: 'MC',
              decimals: 18
            },
            blockExplorerUrls: ['https://mcerscan.com/']
          }]
        });
      }
    }
  };
};
```

##### ğŸ¯ ç”¨æˆ·å¼•å¯¼ç•Œé¢
```jsx
const WalletSetupWizard = () => {
  return (
    <div className="wallet-setup-wizard">
      <h2>ğŸ”— é’±åŒ…è¿æ¥å‘å¯¼</h2>
      
      <div className="step-by-step">
        <div className="step">
          <h3>æ­¥éª¤ 1: å®‰è£…MetaMask</h3>
          <p>å¦‚æœæ‚¨è¿˜æ²¡æœ‰MetaMaské’±åŒ…ï¼Œè¯·å…ˆå®‰è£…ï¼š</p>
          <a href="https://metamask.io/download/" target="_blank">
            ğŸ“¥ ä¸‹è½½MetaMask
          </a>
        </div>
        
        <div className="step">
          <h3>æ­¥éª¤ 2: æ·»åŠ MC Chainç½‘ç»œ</h3>
          <button onClick={autoAddNetwork}>
            ğŸŒ è‡ªåŠ¨æ·»åŠ MC Chainç½‘ç»œ
          </button>
          <details>
            <summary>æ‰‹åŠ¨æ·»åŠ ç½‘ç»œä¿¡æ¯</summary>
            <ul>
              <li>ç½‘ç»œåç§°: MC Chain</li>
              <li>RPC URL: https://chain.mcerscan.com/</li>
              <li>é“¾ID: 88813</li>
              <li>è´§å¸ç¬¦å·: MC</li>
            </ul>
          </details>
        </div>
        
        <div className="step">
          <h3>æ­¥éª¤ 3: è¿æ¥é’±åŒ…</h3>
          <button onClick={connectWallet}>
            ğŸ”— è¿æ¥MetaMaské’±åŒ…
          </button>
        </div>
      </div>
    </div>
  );
};
```

#### 2. ç½‘ç»œåˆ‡æ¢é—®é¢˜
**è§£å†³æ–¹æ¡ˆ**: è‡ªåŠ¨ç½‘ç»œæ£€æµ‹å’Œåˆ‡æ¢

```typescript
const NetworkManager = {
  async ensureCorrectNetwork() {
    const currentChainId = await window.ethereum.request({ method: 'eth_chainId' });
    const targetChainId = '0x15A85'; // MC Chain
    
    if (currentChainId !== targetChainId) {
      await this.switchToMCChain();
    }
  },
  
  async switchToMCChain() {
    try {
      await window.ethereum.request({
        method: 'wallet_switchEthereumChain',
        params: [{ chainId: '0x15A85' }],
      });
    } catch (error) {
      if (error.code === 4902) {
        await this.addMCChainNetwork();
      }
    }
  }
};
```

---

## ğŸ’¸ é—®é¢˜ç±»åˆ«äºŒï¼šäº¤æ˜“å¤±è´¥é—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. Gasè´¹ç”¨ä¸è¶³
**é—®é¢˜æè¿°**: äº¤æ˜“å› Gasè´¹ç”¨ä¸è¶³è€Œå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:

##### ğŸ“Š æ™ºèƒ½Gasä¼°ç®—
```typescript
const GasEstimator = {
  async estimateGasWithBuffer(transaction) {
    try {
      const gasEstimate = await contract.estimateGas[transaction.method](...transaction.params);
      const gasWithBuffer = gasEstimate.mul(120).div(100); // 20% buffer
      
      return {
        gasLimit: gasWithBuffer,
        gasPrice: await this.getOptimalGasPrice()
      };
    } catch (error) {
      return this.getFallbackGasSettings();
    }
  },
  
  async getOptimalGasPrice() {
    // MC Chainé€šå¸¸ä½¿ç”¨å›ºå®šGasä»·æ ¼
    return ethers.utils.parseUnits('1', 'gwei');
  },
  
  getFallbackGasSettings() {
    return {
      gasLimit: 500000, // å®‰å…¨çš„é»˜è®¤å€¼
      gasPrice: ethers.utils.parseUnits('1', 'gwei')
    };
  }
};
```

##### ğŸ¯ ç”¨æˆ·å‹å¥½çš„Gasæç¤º
```jsx
const GasEstimateDisplay = ({ transaction }) => {
  const [gasEstimate, setGasEstimate] = useState(null);
  
  useEffect(() => {
    estimateTransactionCost(transaction).then(setGasEstimate);
  }, [transaction]);
  
  return (
    <div className="gas-estimate">
      <h4>â›½ é¢„ä¼°äº¤æ˜“è´¹ç”¨</h4>
      <div className="gas-info">
        <span>Gasè´¹ç”¨: {gasEstimate?.cost} MC</span>
        <span>é¢„è®¡ç¡®è®¤æ—¶é—´: ~5ç§’</span>
      </div>
      
      {gasEstimate?.insufficient && (
        <div className="warning">
          âš ï¸ MCä½™é¢ä¸è¶³ï¼Œè¯·å…ˆè·å–MCä»£å¸
          <button onClick={showMCPurchaseGuide}>
            ğŸ’° å¦‚ä½•è·å–MC
          </button>
        </div>
      )}
    </div>
  );
};
```

#### 2. äº¤æ˜“æ»‘ç‚¹è¿‡å¤§
**é—®é¢˜æè¿°**: Swapäº¤æ˜“å› ä»·æ ¼æ»‘ç‚¹è¿‡å¤§è€Œå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:

##### ğŸ“ˆ åŠ¨æ€æ»‘ç‚¹ç®¡ç†
```typescript
const SlippageManager = {
  calculateOptimalSlippage(tradeAmount, liquidityPool) {
    const poolSize = liquidityPool.mcReserve.add(liquidityPool.jbcReserve);
    const tradeImpact = tradeAmount.mul(10000).div(poolSize);
    
    if (tradeImpact.lt(100)) return 1; // 1% for small trades
    if (tradeImpact.lt(500)) return 3; // 3% for medium trades
    return 5; // 5% for large trades
  },
  
  async getRecommendedSlippage(fromToken, toToken, amount) {
    const poolInfo = await this.getPoolInfo(fromToken, toToken);
    const priceImpact = this.calculatePriceImpact(amount, poolInfo);
    
    return Math.max(priceImpact * 1.5, 1); // è‡³å°‘1%æ»‘ç‚¹
  }
};
```

##### ğŸ¯ æ»‘ç‚¹è®¾ç½®ç•Œé¢
```jsx
const SlippageSettings = ({ onSlippageChange }) => {
  const [customSlippage, setCustomSlippage] = useState('');
  const presetSlippages = [1, 3, 5, 10];
  
  return (
    <div className="slippage-settings">
      <h4>ğŸ¯ æ»‘ç‚¹å®¹å¿åº¦è®¾ç½®</h4>
      
      <div className="preset-slippages">
        {presetSlippages.map(slippage => (
          <button 
            key={slippage}
            onClick={() => onSlippageChange(slippage)}
            className="slippage-preset"
          >
            {slippage}%
          </button>
        ))}
      </div>
      
      <div className="custom-slippage">
        <input
          type="number"
          placeholder="è‡ªå®šä¹‰æ»‘ç‚¹%"
          value={customSlippage}
          onChange={(e) => setCustomSlippage(e.target.value)}
          max="50"
          min="0.1"
          step="0.1"
        />
        <button onClick={() => onSlippageChange(parseFloat(customSlippage))}>
          è®¾ç½®
        </button>
      </div>
      
      <div className="slippage-warning">
        âš ï¸ æ³¨æ„ï¼šæ»‘ç‚¹è®¾ç½®è¿‡ä½å¯èƒ½å¯¼è‡´äº¤æ˜“å¤±è´¥ï¼Œè¿‡é«˜å¯èƒ½å¯¼è‡´æŸå¤±
      </div>
    </div>
  );
};
```

#### 3. åˆçº¦äº¤äº’å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**: æ™ºèƒ½é‡è¯•æœºåˆ¶

```typescript
const TransactionManager = {
  async executeWithRetry(transaction, maxRetries = 3) {
    for (let i = 0; i < maxRetries; i++) {
      try {
        const tx = await transaction();
        const receipt = await tx.wait();
        
        if (receipt.status === 1) {
          return { success: true, receipt };
        }
      } catch (error) {
        if (i === maxRetries - 1) {
          return { success: false, error: this.parseError(error) };
        }
        
        // ç­‰å¾…åé‡è¯•
        await this.delay(1000 * (i + 1));
      }
    }
  },
  
  parseError(error) {
    if (error.code === 'INSUFFICIENT_FUNDS') {
      return 'ä½™é¢ä¸è¶³ï¼Œè¯·æ£€æŸ¥MCä»£å¸ä½™é¢';
    }
    if (error.message.includes('slippage')) {
      return 'ä»·æ ¼æ»‘ç‚¹è¿‡å¤§ï¼Œè¯·è°ƒæ•´æ»‘ç‚¹è®¾ç½®æˆ–ç¨åé‡è¯•';
    }
    if (error.message.includes('deadline')) {
      return 'äº¤æ˜“è¶…æ—¶ï¼Œè¯·é‡æ–°æäº¤';
    }
    return 'äº¤æ˜“å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
  }
};
```

---

## ğŸ† é—®é¢˜ç±»åˆ«ä¸‰ï¼šå¥–åŠ±ç†è§£é—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. å¥–åŠ±è®¡ç®—ä¸æ¸…æ¥š
**è§£å†³æ–¹æ¡ˆ**: å¯è§†åŒ–å¥–åŠ±è®¡ç®—å™¨

```jsx
const RewardCalculator = () => {
  const [ticketAmount, setTicketAmount] = useState(100);
  const [stakeAmount, setStakeAmount] = useState(150);
  const [stakePeriod, setStakePeriod] = useState(7);
  const [teamSize, setTeamSize] = useState(0);
  
  const calculateRewards = () => {
    // ç›´æ¨å¥–åŠ±
    const directReward = ticketAmount * 0.25;
    
    // é™æ€å¥–åŠ±
    const dailyRate = stakePeriod === 7 ? 0.0133 : stakePeriod === 15 ? 0.0167 : 0.02;
    const staticReward = stakeAmount * dailyRate * stakePeriod;
    
    // çº§å·®å¥–åŠ±
    const level = getLevel(teamSize);
    const differentialReward = stakeAmount * (level.percent / 100);
    
    return {
      direct: directReward,
      static: staticReward,
      differential: differentialReward,
      total: directReward + staticReward + differentialReward
    };
  };
  
  return (
    <div className="reward-calculator">
      <h3>ğŸ§® å¥–åŠ±è®¡ç®—å™¨</h3>
      
      <div className="input-section">
        <div className="input-group">
          <label>é—¨ç¥¨é‡‘é¢ (MC)</label>
          <select value={ticketAmount} onChange={(e) => setTicketAmount(Number(e.target.value))}>
            <option value={100}>100 MC</option>
            <option value={300}>300 MC</option>
            <option value={500}>500 MC</option>
            <option value={1000}>1000 MC</option>
          </select>
        </div>
        
        <div className="input-group">
          <label>è´¨æŠ¼é‡‘é¢ (MC)</label>
          <input 
            type="number" 
            value={stakeAmount}
            onChange={(e) => setStakeAmount(Number(e.target.value))}
          />
        </div>
        
        <div className="input-group">
          <label>è´¨æŠ¼å‘¨æœŸ</label>
          <select value={stakePeriod} onChange={(e) => setStakePeriod(Number(e.target.value))}>
            <option value={7}>7å¤© (1.33%æ—¥æ”¶ç›Š)</option>
            <option value={15}>15å¤© (1.67%æ—¥æ”¶ç›Š)</option>
            <option value={30}>30å¤© (2.00%æ—¥æ”¶ç›Š)</option>
          </select>
        </div>
        
        <div className="input-group">
          <label>å›¢é˜Ÿè§„æ¨¡</label>
          <input 
            type="number" 
            value={teamSize}
            onChange={(e) => setTeamSize(Number(e.target.value))}
            placeholder="å›¢é˜Ÿæ€»äººæ•°"
          />
        </div>
      </div>
      
      <div className="results-section">
        <h4>ğŸ’° é¢„æœŸæ”¶ç›Š</h4>
        <div className="reward-breakdown">
          <div className="reward-item">
            <span>ğŸ‘¥ ç›´æ¨å¥–åŠ±:</span>
            <span>{calculateRewards().direct} MC</span>
          </div>
          <div className="reward-item">
            <span>ğŸ’ é™æ€å¥–åŠ±:</span>
            <span>{calculateRewards().static.toFixed(2)} MC</span>
          </div>
          <div className="reward-item">
            <span>ğŸ“ˆ çº§å·®å¥–åŠ±:</span>
            <span>{calculateRewards().differential.toFixed(2)} MC</span>
          </div>
          <div className="reward-total">
            <span>ğŸ† æ€»æ”¶ç›Š:</span>
            <span>{calculateRewards().total.toFixed(2)} MC</span>
          </div>
        </div>
      </div>
    </div>
  );
};
```

#### 2. ç­‰çº§ç³»ç»Ÿä¸ç†è§£
**è§£å†³æ–¹æ¡ˆ**: äº’åŠ¨å¼ç­‰çº§è¿›åº¦å›¾

```jsx
const LevelProgressVisualization = ({ currentTeamSize }) => {
  const levels = [
    { level: 'V0', requirement: 0, percent: 0 },
    { level: 'V1', requirement: 10, percent: 5 },
    { level: 'V2', requirement: 30, percent: 10 },
    { level: 'V3', requirement: 100, percent: 15 },
    { level: 'V4', requirement: 300, percent: 20 },
    { level: 'V5', requirement: 1000, percent: 25 },
    { level: 'V6', requirement: 3000, percent: 30 },
    { level: 'V7', requirement: 10000, percent: 35 },
    { level: 'V8', requirement: 30000, percent: 40 },
    { level: 'V9', requirement: 100000, percent: 45 }
  ];
  
  const getCurrentLevel = () => {
    for (let i = levels.length - 1; i >= 0; i--) {
      if (currentTeamSize >= levels[i].requirement) {
        return { ...levels[i], index: i };
      }
    }
    return { ...levels[0], index: 0 };
  };
  
  const getNextLevel = () => {
    const current = getCurrentLevel();
    return current.index < levels.length - 1 ? levels[current.index + 1] : null;
  };
  
  return (
    <div className="level-progress">
      <h3>ğŸ… ç­‰çº§è¿›åº¦</h3>
      
      <div className="current-status">
        <div className="current-level">
          <span className="level-badge">{getCurrentLevel().level}</span>
          <span className="level-percent">{getCurrentLevel().percent}% çº§å·®æ”¶ç›Š</span>
        </div>
        <div className="team-size">
          <span>å½“å‰å›¢é˜Ÿ: {currentTeamSize} äºº</span>
        </div>
      </div>
      
      {getNextLevel() && (
        <div className="next-level">
          <h4>ğŸ¯ ä¸‹ä¸€ç­‰çº§: {getNextLevel().level}</h4>
          <div className="progress-bar">
            <div 
              className="progress-fill"
              style={{ 
                width: `${(currentTeamSize / getNextLevel().requirement) * 100}%` 
              }}
            />
          </div>
          <div className="progress-text">
            è¿˜éœ€è¦ {getNextLevel().requirement - currentTeamSize} äºº
            å³å¯è·å¾— {getNextLevel().percent}% çº§å·®æ”¶ç›Š
          </div>
        </div>
      )}
      
      <div className="level-chart">
        {levels.map((level, index) => (
          <div 
            key={level.level}
            className={`level-item ${currentTeamSize >= level.requirement ? 'achieved' : 'locked'}`}
          >
            <div className="level-info">
              <span className="level-name">{level.level}</span>
              <span className="level-requirement">{level.requirement}+ äºº</span>
              <span className="level-reward">{level.percent}%</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};
```

---

## ğŸ”„ é—®é¢˜ç±»åˆ«å››ï¼šæ“ä½œæµç¨‹é—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. æ“ä½œæ­¥éª¤ä¸æ¸…æ¥š
**è§£å†³æ–¹æ¡ˆ**: åˆ†æ­¥å¼•å¯¼ç³»ç»Ÿ

```jsx
const StepByStepGuide = ({ operation }) => {
  const [currentStep, setCurrentStep] = useState(0);
  
  const operationSteps = {
    buyTicket: [
      {
        title: "å‡†å¤‡MCä»£å¸",
        description: "ç¡®ä¿é’±åŒ…ä¸­æœ‰è¶³å¤Ÿçš„MCä»£å¸",
        action: "checkBalance",
        component: <BalanceChecker />
      },
      {
        title: "é€‰æ‹©é—¨ç¥¨ç­‰çº§",
        description: "æ ¹æ®æ‚¨çš„æŠ•èµ„èƒ½åŠ›é€‰æ‹©åˆé€‚çš„é—¨ç¥¨",
        action: "selectTicket",
        component: <TicketSelector />
      },
      {
        title: "ç»‘å®šæ¨èäºº",
        description: "è¾“å…¥æ¨èäººåœ°å€ï¼ˆå¯é€‰ï¼‰",
        action: "bindReferrer",
        component: <ReferrerInput />
      },
      {
        title: "ç¡®è®¤è´­ä¹°",
        description: "æ£€æŸ¥ä¿¡æ¯å¹¶ç¡®è®¤äº¤æ˜“",
        action: "confirmPurchase",
        component: <PurchaseConfirmation />
      }
    ],
    
    stakeLiquidity: [
      {
        title: "æ£€æŸ¥é—¨ç¥¨çŠ¶æ€",
        description: "ç¡®ä¿æ‚¨æœ‰æœ‰æ•ˆçš„é—¨ç¥¨",
        action: "checkTicket",
        component: <TicketStatusChecker />
      },
      {
        title: "å‡†å¤‡è´¨æŠ¼é‡‘é¢",
        description: "å‡†å¤‡é—¨ç¥¨é‡‘é¢1.5å€çš„MCä»£å¸",
        action: "prepareStake",
        component: <StakeAmountCalculator />
      },
      {
        title: "é€‰æ‹©è´¨æŠ¼å‘¨æœŸ",
        description: "é€‰æ‹©7å¤©ã€15å¤©æˆ–30å¤©è´¨æŠ¼å‘¨æœŸ",
        action: "selectPeriod",
        component: <PeriodSelector />
      },
      {
        title: "ç¡®è®¤è´¨æŠ¼",
        description: "æ£€æŸ¥ä¿¡æ¯å¹¶æäº¤è´¨æŠ¼",
        action: "confirmStake",
        component: <StakeConfirmation />
      }
    ]
  };
  
  const steps = operationSteps[operation] || [];
  
  return (
    <div className="step-guide">
      <div className="step-progress">
        {steps.map((step, index) => (
          <div 
            key={index}
            className={`step-indicator ${index <= currentStep ? 'completed' : 'pending'}`}
          >
            <span className="step-number">{index + 1}</span>
            <span className="step-title">{step.title}</span>
          </div>
        ))}
      </div>
      
      <div className="step-content">
        <h3>{steps[currentStep]?.title}</h3>
        <p>{steps[currentStep]?.description}</p>
        {steps[currentStep]?.component}
        
        <div className="step-actions">
          {currentStep > 0 && (
            <button onClick={() => setCurrentStep(currentStep - 1)}>
              â¬…ï¸ ä¸Šä¸€æ­¥
            </button>
          )}
          {currentStep < steps.length - 1 && (
            <button onClick={() => setCurrentStep(currentStep + 1)}>
              ä¸‹ä¸€æ­¥ â¡ï¸
            </button>
          )}
        </div>
      </div>
    </div>
  );
};
```

#### 2. çŠ¶æ€è·Ÿè¸ªå›°éš¾
**è§£å†³æ–¹æ¡ˆ**: å®æ—¶çŠ¶æ€ä»ªè¡¨æ¿

```jsx
const UserDashboard = () => {
  const [userStatus, setUserStatus] = useState(null);
  
  useEffect(() => {
    loadUserStatus().then(setUserStatus);
  }, []);
  
  return (
    <div className="user-dashboard">
      <h2>ğŸ“Š æˆ‘çš„çŠ¶æ€</h2>
      
      <div className="status-cards">
        <div className="status-card">
          <h3>ğŸ« é—¨ç¥¨çŠ¶æ€</h3>
          <div className="status-info">
            {userStatus?.ticket ? (
              <>
                <span>ç­‰çº§: {userStatus.ticket.level}</span>
                <span>é‡‘é¢: {userStatus.ticket.amount} MC</span>
                <span>æ”¶ç›Š: {userStatus.ticket.earned}/{userStatus.ticket.cap} MC</span>
                <div className="progress-bar">
                  <div 
                    className="progress"
                    style={{ width: `${(userStatus.ticket.earned / userStatus.ticket.cap) * 100}%` }}
                  />
                </div>
              </>
            ) : (
              <span className="no-ticket">æš‚æ— é—¨ç¥¨</span>
            )}
          </div>
        </div>
        
        <div className="status-card">
          <h3>ğŸ’§ è´¨æŠ¼çŠ¶æ€</h3>
          <div className="stakes-list">
            {userStatus?.stakes?.map((stake, index) => (
              <div key={index} className="stake-item">
                <span>é‡‘é¢: {stake.amount} MC</span>
                <span>å‘¨æœŸ: {stake.period}å¤©</span>
                <span>çŠ¶æ€: {stake.active ? 'è¿›è¡Œä¸­' : 'å·²å®Œæˆ'}</span>
                <span>æ”¶ç›Š: {stake.earned} MC</span>
              </div>
            ))}
          </div>
        </div>
        
        <div className="status-card">
          <h3>ğŸ‘¥ å›¢é˜ŸçŠ¶æ€</h3>
          <div className="team-info">
            <span>ç›´æ¨äººæ•°: {userStatus?.team?.directCount}</span>
            <span>å›¢é˜Ÿæ€»æ•°: {userStatus?.team?.totalCount}</span>
            <span>å½“å‰ç­‰çº§: {userStatus?.team?.level}</span>
            <span>çº§å·®æ”¶ç›Šç‡: {userStatus?.team?.percent}%</span>
          </div>
        </div>
        
        <div className="status-card">
          <h3>ğŸ’° æ”¶ç›Šç»Ÿè®¡</h3>
          <div className="earnings-breakdown">
            <span>é™æ€å¥–åŠ±: {userStatus?.earnings?.static} MC</span>
            <span>ç›´æ¨å¥–åŠ±: {userStatus?.earnings?.direct} MC</span>
            <span>å±‚çº§å¥–åŠ±: {userStatus?.earnings?.level} MC</span>
            <span>çº§å·®å¥–åŠ±: {userStatus?.earnings?.differential} MC</span>
            <div className="total-earnings">
              æ€»æ”¶ç›Š: {userStatus?.earnings?.total} MC
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};
```

---

## ğŸ“± é—®é¢˜ç±»åˆ«äº”ï¼šæ•°æ®æ˜¾ç¤ºé—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. æ•°æ®æ›´æ–°å»¶è¿Ÿ
**è§£å†³æ–¹æ¡ˆ**: å®æ—¶æ•°æ®åŒæ­¥

```typescript
const DataSyncManager = {
  subscriptions: new Map(),
  
  subscribe(dataType, callback) {
    if (!this.subscriptions.has(dataType)) {
      this.subscriptions.set(dataType, new Set());
    }
    this.subscriptions.get(dataType).add(callback);
    
    // ç«‹å³è·å–æœ€æ–°æ•°æ®
    this.fetchLatestData(dataType).then(callback);
  },
  
  unsubscribe(dataType, callback) {
    this.subscriptions.get(dataType)?.delete(callback);
  },
  
  async fetchLatestData(dataType) {
    switch (dataType) {
      case 'userBalance':
        return await this.getUserBalance();
      case 'stakingRewards':
        return await this.getStakingRewards();
      case 'teamStats':
        return await this.getTeamStats();
      default:
        return null;
    }
  },
  
  startPolling() {
    setInterval(() => {
      this.subscriptions.forEach((callbacks, dataType) => {
        this.fetchLatestData(dataType).then(data => {
          callbacks.forEach(callback => callback(data));
        });
      });
    }, 10000); // æ¯10ç§’æ›´æ–°ä¸€æ¬¡
  }
};
```

#### 2. æ•°æ®æ ¼å¼åŒ–é—®é¢˜
**è§£å†³æ–¹æ¡ˆ**: ç»Ÿä¸€æ•°æ®æ ¼å¼åŒ–å·¥å…·

```typescript
const DataFormatter = {
  formatTokenAmount(amount, decimals = 18, symbol = 'MC') {
    const formatted = ethers.utils.formatUnits(amount, decimals);
    const number = parseFloat(formatted);
    
    if (number >= 1000000) {
      return `${(number / 1000000).toFixed(2)}M ${symbol}`;
    }
    if (number >= 1000) {
      return `${(number / 1000).toFixed(2)}K ${symbol}`;
    }
    return `${number.toFixed(4)} ${symbol}`;
  },
  
  formatPercentage(value, decimals = 2) {
    return `${(value * 100).toFixed(decimals)}%`;
  },
  
  formatTimeRemaining(endTime) {
    const now = Date.now();
    const remaining = endTime - now;
    
    if (remaining <= 0) return 'å·²ç»“æŸ';
    
    const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
    const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
    
    if (days > 0) return `${days}å¤© ${hours}å°æ—¶`;
    if (hours > 0) return `${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
    return `${minutes}åˆ†é’Ÿ`;
  }
};
```

---

## ğŸŒ é—®é¢˜ç±»åˆ«å…­ï¼šç½‘ç»œé—®é¢˜

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. RPCèŠ‚ç‚¹ä¸ç¨³å®š
**è§£å†³æ–¹æ¡ˆ**: å¤šRPCèŠ‚ç‚¹å®¹é”™

```typescript
const RPCManager = {
  rpcEndpoints: [
    'https://chain.mcerscan.com/',
    'https://rpc.mcchain.io/',
    'https://mc-rpc-backup.com/' // å¤‡ç”¨èŠ‚ç‚¹
  ],
  
  currentRPCIndex: 0,
  
  async getProvider() {
    for (let i = 0; i < this.rpcEndpoints.length; i++) {
      const rpcUrl = this.rpcEndpoints[(this.currentRPCIndex + i) % this.rpcEndpoints.length];
      
      try {
        const provider = new ethers.providers.JsonRpcProvider(rpcUrl);
        await provider.getBlockNumber(); // æµ‹è¯•è¿æ¥
        
        this.currentRPCIndex = (this.currentRPCIndex + i) % this.rpcEndpoints.length;
        return provider;
      } catch (error) {
        console.warn(`RPC ${rpcUrl} è¿æ¥å¤±è´¥:`, error);
      }
    }
    
    throw new Error('æ‰€æœ‰RPCèŠ‚ç‚¹éƒ½æ— æ³•è¿æ¥');
  },
  
  async executeWithFallback(operation) {
    for (let i = 0; i < this.rpcEndpoints.length; i++) {
      try {
        const provider = await this.getProvider();
        return await operation(provider);
      } catch (error) {
        if (i === this.rpcEndpoints.length - 1) {
          throw error;
        }
        this.currentRPCIndex = (this.currentRPCIndex + 1) % this.rpcEndpoints.length;
      }
    }
  }
};
```

#### 2. ç½‘ç»œå»¶è¿Ÿé—®é¢˜
**è§£å†³æ–¹æ¡ˆ**: ç¦»çº¿ç¼“å­˜å’Œé¢„åŠ è½½

```typescript
const CacheManager = {
  cache: new Map(),
  
  async getCachedData(key, fetcher, ttl = 30000) {
    const cached = this.cache.get(key);
    
    if (cached && Date.now() - cached.timestamp < ttl) {
      return cached.data;
    }
    
    try {
      const data = await fetcher();
      this.cache.set(key, {
        data,
        timestamp: Date.now()
      });
      return data;
    } catch (error) {
      // å¦‚æœç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¿”å›ç¼“å­˜çš„æ•°æ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
      if (cached) {
        return cached.data;
      }
      throw error;
    }
  },
  
  preloadCriticalData() {
    // é¢„åŠ è½½å…³é”®æ•°æ®
    this.getCachedData('poolInfo', () => getPoolInfo());
    this.getCachedData('tokenPrices', () => getTokenPrices());
    this.getCachedData('userBalance', () => getUserBalance());
  }
};
```

---

## ğŸ› ï¸ ç»¼åˆè§£å†³æ–¹æ¡ˆæ¶æ„

### ğŸ“Š é—®é¢˜ç›‘æ§ç³»ç»Ÿ

```typescript
const ProblemMonitor = {
  errorCounts: new Map(),
  
  reportError(category, error, userAgent) {
    const key = `${category}_${error.code || 'unknown'}`;
    const count = this.errorCounts.get(key) || 0;
    this.errorCounts.set(key, count + 1);
    
    // å‘é€åˆ°ç›‘æ§æœåŠ¡
    this.sendToAnalytics({
      category,
      error: error.message,
      userAgent,
      timestamp: Date.now(),
      count: count + 1
    });
    
    // å¦‚æœé”™è¯¯é¢‘ç‡è¿‡é«˜ï¼Œè§¦å‘å‘Šè­¦
    if (count > 10) {
      this.triggerAlert(category, error);
    }
  },
  
  async sendToAnalytics(data) {
    try {
      await fetch('/api/analytics/error', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
    } catch (e) {
      console.warn('Failed to send analytics:', e);
    }
  }
};
```

### ğŸ¯ ç”¨æˆ·å¸®åŠ©ä¸­å¿ƒ

```jsx
const HelpCenter = () => {
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');
  
  const helpArticles = [
    {
      id: 1,
      title: "å¦‚ä½•è¿æ¥MetaMaské’±åŒ…ï¼Ÿ",
      category: "wallet",
      content: "è¯¦ç»†çš„é’±åŒ…è¿æ¥æ­¥éª¤...",
      tags: ["é’±åŒ…", "è¿æ¥", "MetaMask"]
    },
    {
      id: 2,
      title: "é—¨ç¥¨è´­ä¹°å¤±è´¥æ€ä¹ˆåŠï¼Ÿ",
      category: "transaction",
      content: "äº¤æ˜“å¤±è´¥çš„å¸¸è§åŸå› å’Œè§£å†³æ–¹æ³•...",
      tags: ["é—¨ç¥¨", "è´­ä¹°", "å¤±è´¥"]
    },
    // æ›´å¤šå¸®åŠ©æ–‡ç« ...
  ];
  
  return (
    <div className="help-center">
      <h2>ğŸ†˜ å¸®åŠ©ä¸­å¿ƒ</h2>
      
      <div className="search-section">
        <input
          type="text"
          placeholder="æœç´¢é—®é¢˜..."
          value={searchQuery}
          onChange={(e) => setSearchQuery(e.target.value)}
        />
      </div>
      
      <div className="category-filter">
        <button 
          className={selectedCategory === 'all' ? 'active' : ''}
          onClick={() => setSelectedCategory('all')}
        >
          å…¨éƒ¨
        </button>
        <button 
          className={selectedCategory === 'wallet' ? 'active' : ''}
          onClick={() => setSelectedCategory('wallet')}
        >
          é’±åŒ…é—®é¢˜
        </button>
        <button 
          className={selectedCategory === 'transaction' ? 'active' : ''}
          onClick={() => setSelectedCategory('transaction')}
        >
          äº¤æ˜“é—®é¢˜
        </button>
        <button 
          className={selectedCategory === 'rewards' ? 'active' : ''}
          onClick={() => setSelectedCategory('rewards')}
        >
          å¥–åŠ±é—®é¢˜
        </button>
      </div>
      
      <div className="help-articles">
        {helpArticles
          .filter(article => 
            (selectedCategory === 'all' || article.category === selectedCategory) &&
            (searchQuery === '' || 
             article.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
             article.tags.some(tag => tag.includes(searchQuery)))
          )
          .map(article => (
            <div key={article.id} className="help-article">
              <h3>{article.title}</h3>
              <p>{article.content}</p>
              <div className="article-tags">
                {article.tags.map(tag => (
                  <span key={tag} className="tag">{tag}</span>
                ))}
              </div>
            </div>
          ))
        }
      </div>
      
      <div className="contact-support">
        <h3>ğŸ“ è”ç³»å®¢æœ</h3>
        <p>å¦‚æœæ‚¨çš„é—®é¢˜ä»æœªè§£å†³ï¼Œè¯·è”ç³»æˆ‘ä»¬çš„å®¢æœå›¢é˜Ÿï¼š</p>
        <div className="contact-methods">
          <button>ğŸ’¬ åœ¨çº¿å®¢æœ</button>
          <button>ğŸ“§ é‚®ä»¶æ”¯æŒ</button>
          <button>ğŸ“± Telegramç¾¤ç»„</button>
        </div>
      </div>
    </div>
  );
};
```

---

## ğŸ“ˆ å®æ–½ä¼˜å…ˆçº§å»ºè®®

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (ç«‹å³å®æ–½)
1. **é’±åŒ…è¿æ¥ä¼˜åŒ–** - å½±å“æ‰€æœ‰æ–°ç”¨æˆ·
2. **äº¤æ˜“å¤±è´¥å¤„ç†** - å½±å“ç”¨æˆ·ä½“éªŒå’Œèµ„é‡‘å®‰å…¨
3. **åŸºç¡€é”™è¯¯ç›‘æ§** - åŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (1-2å‘¨å†…å®æ–½)
1. **å¥–åŠ±è®¡ç®—å™¨** - å¸®åŠ©ç”¨æˆ·ç†è§£æ”¶ç›Š
2. **æ“ä½œå¼•å¯¼ç³»ç»Ÿ** - é™ä½å­¦ä¹ æˆæœ¬
3. **æ•°æ®åŒæ­¥ä¼˜åŒ–** - æå‡ç”¨æˆ·ä½“éªŒ

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (1ä¸ªæœˆå†…å®æ–½)
1. **å¸®åŠ©ä¸­å¿ƒå®Œå–„** - é•¿æœŸç”¨æˆ·æ”¯æŒ
2. **é«˜çº§ç›‘æ§åŠŸèƒ½** - è¿è¥ä¼˜åŒ–
3. **æ€§èƒ½ä¼˜åŒ–** - ç”¨æˆ·ä½“éªŒæå‡

---

**ğŸ“… æ–‡æ¡£åˆ›å»ºæ—¥æœŸ**: 2025å¹´12æœˆ30æ—¥  
**ğŸ¯ ç›®æ ‡**: æä¾›å…¨é¢çš„ç”¨æˆ·é—®é¢˜è§£å†³æ–¹æ¡ˆ  
**ğŸ“Š è¦†ç›–èŒƒå›´**: é’±åŒ…è¿æ¥ã€äº¤æ˜“å¤„ç†ã€å¥–åŠ±ç†è§£ã€æ“ä½œæµç¨‹ã€æ•°æ®æ˜¾ç¤ºã€ç½‘ç»œé—®é¢˜  
**ğŸ› ï¸ å®æ–½å»ºè®®**: åˆ†é˜¶æ®µå®æ–½ï¼Œä¼˜å…ˆè§£å†³é«˜é¢‘é«˜å½±å“é—®é¢˜